# 批量生成/执行设备脚本工具

## 简介
本工具用于通过 Excel 文件导入设备信息和脚本命令，支持批量生成脚本也可以通过 SSH 直接执行脚本命令，支持执行结果保存。

## 功能
- 读取设备脚本配置 Excel 文件（支持 .xls/.xlsx）
- 显示设备清单和基本统计信息
- 生成纯文本格式的设备脚本并保存到指定路径
- SSH 远程批量执行脚本命令，回显结果保存到指定路径
- 执行进度实时显示
- 支持拖动分隔条调整设备信息与执行结果显示区域大小

## 使用方法
1. 启动 `swtools.py`，进入主界面。
2. 选择设备脚本配置文件（Excel），格式需包含“设备名称”列（列标题必须为“设备名称”），如果需要直接执行脚本，还需要有设备“IP地址”、“账号”、“密码”列和相应列标题，
   其后为脚本命令列，可以没有列标题，每个命令一列，每行命令数量可以不等。
   同一设备的脚本可以有多行，设备行可以无序排列。
3. 点击“生成脚本并保存”可批量生成设备脚本，首先选择脚本结果保存路径，确认路径后开始生成。生成后的脚本
4. 若 Excel 包含登录账号等信息，可点击“生成脚本并执行”批量远程执行命令，首先选择执行结果保存路径，确认路径后开始执行。
5. 执行结果窗口显示软件运行过程信息和报错信息。

## 依赖
- Python 3.7+
- pandas
- paramiko

安装依赖：
```powershell
pip install pandas paramiko
```

## 文件说明
- `swtools.py`：主程序文件
- `设备脚本配置文件-保存脚本.xlsx`：示例设备脚本配置文件，用于生成脚本保存。
- `设备脚本配置文件-执行脚本.xlsx`：示例设备脚本配置文件，用于脚本直接执行。

## 注意事项
- Excel 文件需包含正确的设备信息和脚本列，至少需要“设备名称”列，脚本列可以无列标题，脚本按照从左到右列顺序排列。
- 直接执行脚本命令前请确保网络畅通，设备支持SSH，端口为22。

## 联系方式
如有问题或建议，请联系开发者davidzhou73@163.com。